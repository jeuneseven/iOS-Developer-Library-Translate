[Debugging with Xcode 原文链接](https://developer.apple.com/library/content/documentation/DeveloperTools/Conceptual/debugging_with_xcode/chapters/about_debugging_w_xcode.html#//apple_ref/doc/uid/TP40015022)

# 关于使用Xcode调试
查找和排查代码问题是开发过程中的很重要的步骤。Xcode调试器内置强大功能来进行通用调试，并在你的应用程序加载的时候自动运行。调试器能够帮助你：  

* 确定和定位问题
* 检测运行代码的控制流和数据结构来找到原因
* 根据你的代码设计解决方案和编辑
* 运行修改后的应用程序并确保它的修复能够运行

## 预读
你应当对于应用程序设计和编程的概念比较熟悉。最好对于Xcode比较熟悉；参见《Xcode概览》。
## 另请参见

# 快速开始
## 准备调试
两个在调试时最重要的事情是代码的分析逻辑和流程控制，并确保应用程序展现正确的数据。有逻辑问题的应用程序会展示不可预期的行为：没有事情发生，有错误的事情发生或者应用程序崩溃。执行不正确操作的代码通常会给用户展示错误的数据；想象一下，你点击一个计算器1+1，最终得到结果20。当看到一个问题时，你需要进行调试，要确保应用程序的行为如预期一样，并将正确的结果展示给用户。  
假如你运行你的应用程序然后发现你新添加的代码看起来并没有执行。你不知道是你的代码没有被执行还是它没有产生输出。但你知道肯定有错误发生，你有了一个bug。
## 在调试模式下检测应用程序
其他问题的情况可能会更难发现。在调试模式下检测应用程序能给你机会使用调试仪器来监控系统资源的使用。注意图片的形状，考虑什么是你在运行应用程序时期待看到的以及不同部分的代码被调用来运行。举例来说，若你看到在CPU检测中的尖状波或者再内存检测中持续上升的部分，那么很有是因为某些问题所引起的了。  

![](https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/debugging_with_xcode/Art/dwx-qs-2a_2x.png)  

点开表格的一项能够打开一个更详细的状态报告。  

![](https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/debugging_with_xcode/Art/dwx-qs-3a_2_2x.png)  

无论是你新编写的代码没有按照你的期望运行还是你在调试界面看到了意外状况，你很可能不会立即知道问题的原因。不过，你已经有了以下信息：  

* 你的应用程序在你开始添加新功能之前是运行正常的。
* 直到你使用应用程序的UI运行新代码之前，它的行为都是正确的。
* 你知道你添加到源代码中的新代码是什么。

若要更进一步的隔离原因，你可以设置代码的“断点”。
## 使用断点

## 调试器中的控制

## 在调试器导航中检测回溯

## 通过调试过程进行循环

# 调试工具

## 常用备注

### 调试的五大部分和调试工具

### LLDB和Xcode调试器

### Xcode工具控制

### Xcode调试和Product菜单

## 调试区域

## 断点和断点导航

## 源码编辑器

## 调试导航

## 调试视图层级

## OpenGL ES调试

## Scheme编辑器的调试选项

# 专业调试工作流

## 调试视图层级

## 调试应用程序扩展

## 线程和队列调试

## 内存图调试

## 使用地址清除

## 使用线程清除

## 使用未定义行为清除

## 调试Metal和OpenGL ES

## 使用替代工具链

# 快速查看数据类型
Xcode调试器包含变量快速查看功能，这是一种通过弹出框展示对象变量内容来查看当前对象变量状态的方式，不论是在调试器变量视图中通过点击“快速查看”按钮或是通过点击选中变量的空格键都可以做到。  

![](https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/debugging_with_xcode/Art/dwx-ql-qlbuttons_2x.png)

不是所有的操作系统对象类型都能够通过快速查看来展示，不过很多都可以。以下清单列出了操作系统支持快速查看的常用对象类型：  

类分类  | 对象类型
------------- | -------------
图片类  | NSImage、UIImage、NSImageView、UIImageView、CIImage、NSBitmapImageRep
光标类  | NSCursor
颜色类  | NSColor、UIColor
贝塞尔路径类  | NSBezierPath、UIBezierPath
定位类  | CLLocation
视图类  | NSView、UIView
字符串类  | NSString
属性字符串类  | NSAttributedString
数据类  | NSData
URL类  | NSURL
SpriteKit类  | SKSpriteNode、SKShapeNode、SKTexture、SKTextureAtlas

即使是不在该清单中的对象你也可以尝试使用快速查看功能。若快速查看不支持你选中的对象的类型，Xcode会为该对象展示默认快速查看。  

![](https://developer.apple.com/library/archive/documentation/DeveloperTools/Conceptual/debugging_with_xcode/Art/dwx-ql-default_2x.png)  

你还可以通过给对象类添加渲染方法来扩展自定义对象的快速查看的使用。参见“在Xcode调试器中快速查看自定义类型”来了解如何在你的自定义对象类中实现快速查看。
# 附录：静态分析
在你运行你的应用程序之前，你可以使用静态分析来查找你的代码的bug。静态代码扫描会在短短几秒钟之内尝试上千种可能的方式，报告潜在的隐藏的问题或可能很难复现的问题。这个过程同样能够在你的代码中确定未遵循API使用的部分，比如Foundation，UIKit，和 AppKit等常用库。  
要执行静态代码扫描，请选择Product > Analyze。Xcode静态分析将会解析项目的源代码以及定位以下几种类型的问题：  

* 逻辑缺陷，比如访问了未初始化的变量以及不相关的空指针
* 内存管理缺陷，比如内存分配泄露
* 废弃存储（不再使用的变量）缺陷
* API使用缺陷，未遵循项目使用的框架和库的相关使用方式

在问题导航栏中静态编译会报告相关问题，通过点击项目的导航栏的问题导航按钮即可查看。在问题导航中选择一个静态分析消息会在源代码编译器中展示相关代码。在源代码编辑器中点击相应的消息。使用源代码编辑器上方的静态分析结果栏的弹出菜单来了解缺陷的流程。然后编辑代码来修复缺陷。
## 执行静态代码扫描
查找缺陷——潜在的问题——使用Xcode内置的静态代码扫描来对项目的源代码进行扫描。源代码可能有被编译器忽略的微小问题，但在运行时会展示出来，这样的问题很难定位和修复。  
若要在你的源代码当中使用静态分析查找缺陷：  
  1. 选择Product > Analyze。  
  2. 在问题导航栏，选择一个分析消息。  
  3. 在源代码编辑器中，点击相应的消息。  
  4. 使用源代码编辑器上方的静态分析结果栏的弹出菜单来了解缺陷的流程。  
  5. 编辑代码来修复缺陷。  
你可以通过使用断言，属性或编译指示等指令来禁止分析器产生假阳性信息。  
当你第一次分析一个项目的时候，你可能会发现有大量的问题。不过你要是定期的运行静态扫描并修复其展示的缺陷的话，你会在随后的分析中发现越来越少的问题。尽早分析，经常分析。这对代码有好处。  

```
注意：若静态分析没有报告问题，你不能够假设没有问题。该工具不能够确保检测到源代码的所有问题。
```

```
提示：选择Product > Clean来移除问题导航栏中的静态分析消息。
```